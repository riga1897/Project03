~/workspace$ pytest tests/test_console_interface_simplified.py
=================================== test session starts ====================================
platform linux -- Python 3.11.13, pytest-8.4.2, pluggy-1.6.0
rootdir: /home/runner/workspace
configfile: pyproject.toml
plugins: cov-6.2.1, mock-3.15.0
collected 21 items                                                                         

tests/test_console_interface_simplified.py ........FFF......F...                     [100%]

========================================= FAILURES =========================================
___________ TestUserInterfaceAdvancedMethods.test_advanced_search_with_keywords ____________

self = <tests.test_console_interface_simplified.TestUserInterfaceAdvancedMethods object at 0x7fef5be9ded0>
mock_print = <MagicMock name='print' id='140666008247120'>
mock_formatter = <MagicMock name='VacancyFormatter' id='140666008279504'>
mock_paginate = <MagicMock name='quick_paginate' id='140666008273552'>
mock_input = <MagicMock name='get_user_input' id='140666008286416'>

    @patch('src.ui_interfaces.console_interface.get_user_input', return_value="python, django")
    @patch('src.ui_interfaces.console_interface.quick_paginate')
    @patch('src.ui_interfaces.console_interface.VacancyFormatter')
    @patch('builtins.print')
    def test_advanced_search_with_keywords(self, mock_print, mock_formatter, mock_paginate, mock_input):
        """Тест расширенного поиска с ключевыми словами"""
        ui = self._create_ui()
        ui.storage.get_vacancies.return_value = [MagicMock(), MagicMock()]
        ui.vacancy_ops.filter_vacancies_by_multiple_keywords.return_value = [MagicMock()]
    
        ui._advanced_search_vacancies()
    
        # Проверяем что методы были вызваны (не все объекты могут иметь assert_called_once)
>       assert ui.vacancy_ops.filter_vacancies_by_multiple_keywords.called
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: 'function' object has no attribute 'called'

tests/test_console_interface_simplified.py:152: AttributeError
------------------------------------ Captured log call -------------------------------------
WARNING  src.api_modules.sj_api:sj_api.py:55 Используется тестовый API ключ SuperJob.                 Для полной функциональности добавьте реальный ключ                 в переменную окружения SUPERJOB_API_KEY
WARNING  src.utils.vacancy_operations:vacancy_operations.py:232 Метод search_by_keywords устарел. Используйте SQLFilterService
______________ TestUserInterfaceAdvancedMethods.test_filter_by_salary_minimum ______________

self = <tests.test_console_interface_simplified.TestUserInterfaceAdvancedMethods object at 0x7fef5be9e4d0>
mock_print = <MagicMock name='print' id='140666008631120'>
mock_formatter = <MagicMock name='VacancyFormatter' id='140666008798800'>
mock_paginate = <MagicMock name='quick_paginate' id='140666008807184'>
mock_input = <MagicMock name='input' id='140666008396432'>

    @patch('builtins.input', side_effect=['1', '100000'])
    @patch('src.ui_interfaces.console_interface.quick_paginate')
    @patch('src.ui_interfaces.console_interface.VacancyFormatter')
    @patch('builtins.print')
    def test_filter_by_salary_minimum(self, mock_print, mock_formatter, mock_paginate, mock_input):
        """Тест фильтрации по минимальной зарплате"""
        ui = self._create_ui()
        ui.storage.get_vacancies.return_value = [MagicMock()]
        ui.vacancy_ops.filter_vacancies_by_min_salary.return_value = [MagicMock()]
        ui.vacancy_ops.sort_vacancies_by_salary.return_value = [MagicMock()]
    
        ui._filter_saved_vacancies_by_salary()
    
        # Основная цель - покрытие кода
>       assert ui.vacancy_ops.filter_vacancies_by_min_salary.called
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: 'function' object has no attribute 'called'

tests/test_console_interface_simplified.py:169: AttributeError
------------------------------------ Captured log call -------------------------------------
WARNING  src.api_modules.sj_api:sj_api.py:55 Используется тестовый API ключ SuperJob.                 Для полной функциональности добавьте реальный ключ                 в переменную окружения SUPERJOB_API_KEY
ERROR    src.ui_interfaces.console_interface:console_interface.py:300 Ошибка при фильтрации по зарплате: '>=' not supported between instances of 'MagicMock' and 'int'
_______________ TestUserInterfaceAdvancedMethods.test_filter_by_salary_range _______________

self = <tests.test_console_interface_simplified.TestUserInterfaceAdvancedMethods object at 0x7fef5be9eb10>
mock_print = <MagicMock name='print' id='140666008717712'>
mock_formatter = <MagicMock name='VacancyFormatter' id='140666008728528'>
mock_paginate = <MagicMock name='quick_paginate' id='140666008729680'>
mock_parse = <MagicMock name='parse_salary_range' id='140666008890640'>
mock_input = <MagicMock name='input' id='140666003854800'>

    @patch('builtins.input', side_effect=['3', '100000 - 150000'])
    @patch('src.ui_interfaces.console_interface.parse_salary_range', return_value=(100000, 150000))
    @patch('src.ui_interfaces.console_interface.quick_paginate')
    @patch('src.ui_interfaces.console_interface.VacancyFormatter')
    @patch('builtins.print')
    def test_filter_by_salary_range(self, mock_print, mock_formatter, mock_paginate,
                                   mock_parse, mock_input):
        """Тест фильтрации по диапазону зарплат"""
        ui = self._create_ui()
        ui.storage.get_vacancies.return_value = [MagicMock()]
        ui.vacancy_ops.filter_vacancies_by_salary_range.return_value = [MagicMock()]
        ui.vacancy_ops.sort_vacancies_by_salary.return_value = [MagicMock()]
    
        ui._filter_saved_vacancies_by_salary()
    
        # Проверяем что метод был вызван
>       assert ui.vacancy_ops.filter_vacancies_by_salary_range.called
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: 'function' object has no attribute 'called'

tests/test_console_interface_simplified.py:188: AttributeError
------------------------------------ Captured log call -------------------------------------
WARNING  src.api_modules.sj_api:sj_api.py:55 Используется тестовый API ключ SuperJob.                 Для полной функциональности добавьте реальный ключ                 в переменную окружения SUPERJOB_API_KEY
ERROR    src.ui_interfaces.console_interface:console_interface.py:300 Ошибка при фильтрации по зарплате: '<=' not supported between instances of 'int' and 'MagicMock'
___________ TestUserInterfaceRemainingMethods.test_configure_superjob_api_method ___________

self = <tests.test_console_interface_simplified.TestUserInterfaceRemainingMethods object at 0x7fef5bea0450>

    def test_configure_superjob_api_method(self):
        """Тест метода настройки SuperJob API"""
        ui = self._create_ui()
    
        ui._configure_superjob_api()
    
        # Проверяем что метод был вызван через _setup_superjob_api
        # (в оригинальном коде _configure_superjob_api вызывает _setup_superjob_api)
>       assert ui.operations_coordinator.handle_superjob_setup.called
E       AssertionError: assert False
E        +  where False = <MagicMock name='VacancyOperationsCoordinator().handle_superjob_setup' id='140666004709456'>.called
E        +    where <MagicMock name='VacancyOperationsCoordinator().handle_superjob_setup' id='140666004709456'> = <MagicMock name='VacancyOperationsCoordinator()' id='140666008395920'>.handle_superjob_setup
E        +      where <MagicMock name='VacancyOperationsCoordinator()' id='140666008395920'> = <src.ui_interfaces.console_interface.UserInterface object at 0x7fef5cc42610>.operations_coordinator

tests/test_console_interface_simplified.py:303: AssertionError
----------------------------------- Captured stdout call -----------------------------------

============================================================
НАСТРОЙКА SUPERJOB API
============================================================
SuperJob API ключ не настроен или используется тестовый

Для получения API ключа SuperJob:
1. Перейдите на https://api.superjob.ru/register/
2. Зарегистрируйте ваше приложение
3. Получите Secret key
4. Добавьте его в .env как SUPERJOB_API_KEY

Перезапустите приложение

============================================================
------------------------------------ Captured log call -------------------------------------
WARNING  src.api_modules.sj_api:sj_api.py:55 Используется тестовый API ключ SuperJob.                 Для полной функциональности добавьте реальный ключ                 в переменную окружения SUPERJOB_API_KEY
================================= short test summary info ==================================
FAILED tests/test_console_interface_simplified.py::TestUserInterfaceAdvancedMethods::test_advanced_search_with_keywords - AttributeError: 'function' object has no attribute 'called'
FAILED tests/test_console_interface_simplified.py::TestUserInterfaceAdvancedMethods::test_filter_by_salary_minimum - AttributeError: 'function' object has no attribute 'called'
FAILED tests/test_console_interface_simplified.py::TestUserInterfaceAdvancedMethods::test_filter_by_salary_range - AttributeError: 'function' object has no attribute 'called'
FAILED tests/test_console_interface_simplified.py::TestUserInterfaceRemainingMethods::test_configure_superjob_api_method - AssertionError: assert False
=============================== 4 failed, 17 passed in 0.42s ===============================
~/workspace$ 