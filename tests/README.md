
# Тесты для приложения поиска вакансий

Этот каталог содержит тесты для всех компонентов приложения поиска вакансий.

## Структура тестов

- `conftest.py` - Конфигурация pytest и общие фикстуры
- `test_vacancy_models.py` - Тесты для моделей вакансий и зарплат
- `test_storage.py` - Тесты для систем хранения (JSON, PostgreSQL)
- `test_api_modules.py` - Тесты для API модулей (HH, SuperJob)
- `test_vacancy_operations.py` - Тесты для операций с вакансиями
- `test_vacancy_formatter.py` - Тесты для форматирования вакансий
- `test_ui_helpers.py` - Тесты для UI помощников
- `test_integration.py` - Интеграционные тесты

## Запуск тестов

### Все тесты
```bash
pytest tests/
```

### Конкретный файл тестов
```bash
pytest tests/test_vacancy_models.py
```

### Конкретный тест
```bash
pytest tests/test_vacancy_models.py::TestVacancy::test_vacancy_creation_with_dict_salary
```

### С покрытием кода
```bash
pytest tests/ --cov=src --cov-report=html
```

### Только быстрые тесты (исключая медленные)
```bash
pytest tests/ -m "not slow"
```

### Только интеграционные тесты
```bash
pytest tests/ -m integration
```

## Типы тестов

### Unit тесты
- Тестируют отдельные функции и методы
- Используют моки для изоляции от внешних зависимостей
- Быстрые в выполнении

### Integration тесты
- Тестируют взаимодействие между компонентами
- Могут использовать реальные файлы и временные БД
- Более медленные, но проверяют полный workflow

## Фикстуры

### `sample_vacancy`
Предоставляет тестовую вакансию с полным набором данных.

### `sample_vacancies`
Предоставляет список из нескольких тестовых вакансий.

### `temp_json_file`
Создает временный JSON файл для тестирования хранилища.

### `mock_db_config`
Предоставляет мок-конфигурацию для тестирования PostgreSQL.

### `mock_api_response`
Предоставляет мок-ответ API для тестирования парсеров.

## Рекомендации по написанию тестов

1. **Используйте описательные имена**: `test_vacancy_creation_with_dict_salary`
2. **Один тест - одна проверка**: Каждый тест должен проверять одну функциональность
3. **Используйте фикстуры**: Избегайте дублирования настройки тестовых данных
4. **Мокайте внешние зависимости**: API вызовы, файловые операции, БД
5. **Проверяйте граничные случаи**: Пустые данные, некорректные входы
6. **Добавляйте docstrings**: Объясняйте, что тестирует каждый метод

## Дополнительные инструменты

### Coverage отчеты
После запуска тестов с `--cov-report=html` откройте `htmlcov/index.html` для просмотра покрытия кода.

### Профилирование тестов
```bash
pytest tests/ --durations=10
```
Показывает 10 самых медленных тестов.

### Запуск в параллель
```bash
pip install pytest-xdist
pytest tests/ -n auto
```
Запускает тесты в нескольких процессах для ускорения.
